<div class="auth-page">

  <!-- Top brand bar (SAME STYLE AS LOGIN) -->
  <header class="auth-header">
    <div class="brand-left">
      <span class="brand-icon">⚡</span>
      <span class="brand-text">HabitFlow</span>
    </div>

    <div class="brand-right">
      <span class="header-caption">Already have an account?</span>
      <a routerLink="/auth/login" class="header-link">Login</a>
    </div>
  </header>

  <!-- Center card -->
  <main class="auth-main">
    <section class="auth-card">
      <h1 class="auth-title">Sign up</h1>
      <p class="auth-subtitle">
        Create your HabitFlow account to start tracking your habits.
      </p>

      <!-- Global API error (e.g., email already registered) -->
      <p class="auth-banner error" *ngIf="errorMessage">
        {{ errorMessage }}
      </p>

      <!-- Signup form (reactive) -->
      <form [formGroup]="signupForm" (ngSubmit)="onSubmit()" class="auth-form">

        <!-- Name -->
        <div class="field">
          <label for="name">Name*</label>
          <input id="name" type="text" formControlName="name" placeholder="Your name" autocomplete="name"/>
          <div class="field-error" *ngIf="name?.touched && name?.invalid">
            <small *ngIf="name?.errors?.['required']">
              Name is required.
            </small>
            <small *ngIf="name?.errors?.['minlength']">
              Name must be at least 2 characters.
            </small>
          </div>
        </div>

        <!-- Email -->
        <div class="field">
          <label for="email">Email*</label>
          <input
            id="email"
            type="email"
            formControlName="email"
            placeholder="you@example.com"
            autocomplete="email"
          />
          <div class="field-error" *ngIf="email?.touched && email?.invalid">
            <small *ngIf="email?.errors?.['required']">
              Email is required.
            </small>
            <small *ngIf="email?.errors?.['email']">
              Please enter a valid email address.
            </small>
          </div>
        </div>

        <!-- Password -->
        <div class="field">
          <label for="password">Password*</label>
          <input
            id="password"
            type="password"
            formControlName="password"
            placeholder="••••••••"
            autocomplete="new-password"
          />

          <!-- Helper text (always visible) -->
          <p class="field-hint">
            At least 8 characters, including uppercase, lowercase, number and special character.
          </p>

          <div class="field-error" *ngIf="password?.touched && password?.invalid">
            <small *ngIf="password?.errors?.['required']">
              Password is required.
            </small>
            <small *ngIf="password?.errors?.['minlength']">
              Password must be at least 8 characters long.
            </small>
            <small *ngIf="password?.errors?.['pattern']">
              Must include uppercase, lowercase, number, and special character.
            </small>
          </div>
        </div>

        <!-- Submit button -->
        <button
          type="submit" class="primary-btn" [disabled]="signupForm.invalid || loading">
          <span *ngIf="!loading">Sign up</span>
          <span *ngIf="loading">Creating account...</span>
        </button>
      </form>

      <!-- Footer -->
      <p class="auth-footer-text">
        Already have an account?
        <a routerLink="/auth/login">Login</a>
      </p>
    </section>
  </main>
</div>
